<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.54.0" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Building an IVR :: NodeRED at Vonage Campus</title>

    
    <link href="/css/nucleus.css?1571753037" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1571753037" rel="stylesheet">
    <link href="/css/hybrid.css?1571753037" rel="stylesheet">
    <link href="/css/featherlight.min.css?1571753037" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1571753037" rel="stylesheet">
    <link href="/css/auto-complete.css?1571753037" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1571753037" rel="stylesheet">
    <link href="/css/theme.css?1571753037" rel="stylesheet">
    <link href="/css/hugo-theme.css?1571753037" rel="stylesheet">
    
      <link href="/css/theme-blue.css?1571753037" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1571753037"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/building-an-ivr/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://nodered-workshop.nexmodev.com/">
<svg width="250px" height="60px" viewBox="0 0 513 129" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>vc-logo-white</title>
    <desc>Created with Sketch.</desc>
    <defs>
        <polygon id="path-1" points="0.515929367 0.290744617 20.8200773 0.290744617 20.8200773 27.8278891 0.515929367 27.8278891"></polygon>
    </defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Vonage-Campus" transform="translate(-844.000000, -259.000000)">
            <g id="vc-logo-white" transform="translate(844.000000, 259.000000)">
                <polygon id="Fill-1" fill="#FFFFFF" points="65.0234464 92.7179813 18.8776762 17 0 28.8575082 60.8287467 126 71.3170235 126 129 28.8575082 110.122324 17"></polygon>
                <polygon id="Fill-2" fill="#FFFFFF" points="233.033707 0 135 60.8292269 135 71.3175865 233.033707 129 245 110.122175 168.587358 65.0239597 245 18.8778252"></polygon>
                <g id="Group-5" transform="translate(278.000000, 6.000000)">
                    <polygon id="Fill-3" fill="#FFFFFF" points="8.47928528 27.8731523 2.98427949e-13 1.46860693 5.36171965 1.46860693 10.836469 19.6503399 16.1591421 1.46860693 21.4818151 1.46860693 13.1176146 27.8731523"></polygon>
                    <g id="Group-35" transform="translate(1.177975, 0.000000)">
                        <path d="M52.0817389,5.80592126 C48.7350312,5.80592126 47.3663439,8.06908062 47.3663439,14.2550495 C47.3663439,17.7629466 47.7085157,20.215722 48.4308785,21.5358983 C49.1532412,22.857094 50.3708798,23.5360418 52.0817389,23.5360418 C53.7925981,23.5360418 54.97119,22.8937939 55.6935528,21.5736176 C56.4159155,20.2534413 56.7961065,17.8016853 56.7961065,14.2550495 C56.7961065,8.10679994 55.4274191,5.80592126 52.0817389,5.80592126 M52.0817389,0.901389868 C58.1647938,0.901389868 61.928684,5.39100871 61.928684,14.2550495 C61.928684,23.9499349 58.2788511,28.4385343 52.0817389,28.4385343 C45.8846268,28.4385343 42.2337663,23.9499349 42.2337663,14.2550495 C42.2337663,5.39100871 45.9976565,0.901389868 52.0817389,0.901389868" id="Fill-4" fill="#FFFFFF"></path>
                        <polygon id="Fill-6" fill="#FFFFFF" points="85.9104086 27.8731523 85.9104086 1.46860693 90.6638227 1.46860693 100.093585 18.4045828 100.093585 1.46860693 105.264182 1.46860693 105.264182 27.8731523 100.586806 27.8731523 91.0440137 10.9361569 91.0440137 27.8731523"></polygon>
                        <path d="M134.912395,18.367679 L140.653279,18.367679 L137.7628,9.31402216 L134.912395,18.367679 Z M126.357072,27.8729484 L135.596739,1.46840304 L140.121011,1.46840304 L149.321632,27.8729484 L143.846882,27.8729484 L142.2881,23.271191 L133.200509,23.271191 L131.641726,27.8729484 L126.357072,27.8729484 Z" id="Fill-8" fill="#FFFFFF"></path>
                        <path d="M179.577329,18.781878 L179.577329,14.0669627 L190.602866,14.0669627 L190.602866,18.5178427 C190.602866,21.42325 189.691435,23.7995673 187.865491,25.6467947 C186.040574,27.496061 183.683391,28.439044 180.755921,28.439044 C174.557781,28.439044 170.869929,23.9494252 170.869929,14.2555593 C170.869929,5.46593764 174.672866,0.901899589 180.755921,0.901899589 C183.379238,0.901899589 185.585373,1.80818277 187.334251,3.65541015 C189.121149,5.5046764 190.109645,7.80453564 190.29974,10.5590656 L185.508307,11.2002941 C185.166135,7.61695847 183.607353,5.80541154 180.755921,5.80541154 C177.41024,5.80541154 176.002506,8.0685709 176.002506,14.2555593 C176.002506,17.7634563 176.383725,20.2152123 177.106088,21.5353885 C177.82845,22.8565843 179.045061,23.5355321 180.755921,23.5355321 C183.912533,23.5355321 185.432269,21.649566 185.470288,18.781878 L179.577329,18.781878 Z" id="Fill-10" fill="#FFFFFF"></path>
                        <polygon id="Fill-12" fill="#FFFFFF" points="215.612647 27.8731523 215.612647 1.46860693 232.45716 1.46860693 232.45716 6.37109944 220.746252 6.37109944 220.746252 11.5396661 231.391598 11.5396661 231.391598 16.443178 220.746252 16.443178 220.746252 22.9686209 232.45716 22.9686209 232.45716 27.8731523"></polygon>
                        <path d="M19.6198043,64.1967581 C19.4687555,66.87483 18.5172506,69.1390088 16.7293257,70.9862362 C14.9804474,72.7977831 12.7763676,73.7020274 10.077012,73.7020274 C3.87887227,73.7020274 0.191020254,69.213428 0.191020254,59.5185426 C0.191020254,50.7299404 3.99292955,46.1648829 10.077012,46.1648829 C12.7763676,46.1648829 14.9804474,47.0711661 16.7293257,48.9194129 C18.5172506,50.7299404 19.4687555,52.9930998 19.6198043,55.6721911 L14.8293986,56.4632775 C14.4872268,52.8799418 12.9274164,51.0694143 10.077012,51.0694143 C6.73030424,51.0694143 5.3235978,53.3325737 5.3235978,59.5185426 C5.3235978,63.0274591 5.70378873,65.479215 6.4261515,66.7993913 C7.14851427,68.1205871 8.36512524,68.7995349 10.077012,68.7995349 C12.9274164,68.7995349 14.4872268,66.9879879 14.8293986,63.4046523 L19.6198043,64.1967581 Z" id="Fill-14" fill="#FFFFFF"></path>
                        <path d="M49.3823833,63.6312741 L55.1232664,63.6312741 L52.2327878,54.5776172 L49.3823833,63.6312741 Z M40.8270599,73.1365434 L50.066727,46.731998 L54.5909991,46.731998 L63.7916196,73.1365434 L58.3168702,73.1365434 L56.7580874,68.534786 L47.6704966,68.534786 L46.1117138,73.1365434 L40.8270599,73.1365434 Z" id="Fill-16" fill="#FFFFFF"></path>
                        <polygon id="Fill-18" fill="#FFFFFF" points="85.6826023 73.1368492 85.6826023 46.7323039 90.5870653 46.7323039 95.150384 60.2735407 99.7126751 46.7323039 104.618166 46.7323039 104.618166 73.1368492 99.4845606 73.1368492 99.4845606 56.7646243 96.785205 64.6122823 93.515563 64.6122823 90.8151798 56.7646243 90.8151798 73.1368492"></polygon>
                        <path d="M134.797927,58.4255997 L139.28418,58.4255997 C141.071078,58.4255997 142.439765,56.8780881 142.439765,55.0308607 C142.439765,52.9185786 140.95702,51.6351022 139.28418,51.6351022 L134.797927,51.6351022 L134.797927,58.4255997 Z M129.66535,73.137155 L129.66535,46.7315903 L139.246161,46.7315903 C141.527307,46.7315903 143.467308,47.523696 145.101101,49.1456269 C146.73695,50.7298385 147.57337,52.6912433 147.57337,55.0308607 C147.57337,57.3694587 146.773941,59.3308635 145.216186,60.9527944 C143.656376,62.5370059 141.641364,63.3291117 139.246161,63.3291117 L134.797927,63.3291117 L134.797927,73.137155 L129.66535,73.137155 Z" id="Fill-20" fill="#FFFFFF"></path>
                        <path d="M170.755974,46.7318961 L175.889579,46.7318961 L175.889579,63.9329267 C175.889579,66.9127532 177.448362,68.7987193 180.603947,68.7987193 C183.759532,68.7987193 185.319342,66.8750339 185.319342,64.0073459 L185.319342,46.7318961 L190.45192,46.7318961 L190.45192,63.7820494 C190.45192,66.6864373 189.538434,69.0627546 187.714545,70.9110014 C185.889628,72.7592482 183.532445,73.7022313 180.603947,73.7022313 C177.676477,73.7022313 175.318265,72.7592482 173.494377,70.9110014 C171.66946,69.0627546 170.755974,66.6864373 170.755974,63.7820494 L170.755974,46.7318961 Z" id="Fill-22" fill="#FFFFFF"></path>
                        <g id="Group-26" transform="translate(212.701412, 45.874852)">
                            <mask id="mask-2" fill="white">
                                <use xlink:href="#path-1"></use>
                            </mask>
                            <g id="Clip-25"></g>
                            <path d="M5.26934353,17.1900206 C5.42039236,18.3593196 5.57349628,19.0382674 6.06671694,20.2075664 C6.82812634,21.67862 8.19681369,22.9243771 11.0482457,22.9243771 C13.6715631,22.9243771 15.6876025,21.7550781 15.6876025,19.4541994 C15.6876025,17.4540559 14.3189152,16.361215 10.8201311,15.4549318 C8.08275641,14.7382647 6.33387813,14.0970362 4.62199141,12.9277372 C2.91113222,11.7207188 2.03669309,9.94689123 2.03669309,7.5705739 C2.03669309,5.57246924 2.79810249,3.87408027 4.35585776,2.44074601 C5.91566811,1.00741175 8.08275641,0.290744617 10.8201311,0.290744617 C15.4204414,0.290744617 19.1093209,2.85565856 20.2118746,7.5705739 L15.4584604,8.58899561 C14.9652398,6.77846812 13.4434485,5.19425657 10.8201311,5.19425657 C8.57700462,5.19425657 7.17029818,6.25141704 7.17029818,7.5705739 C7.17029818,9.04264692 8.76710009,9.68387541 12.2658842,10.7400164 C14.8121359,11.5321222 16.5990332,12.2854892 17.5875297,12.964437 C19.7556455,14.4365101 20.8201801,16.5865115 20.8201801,19.4541994 C20.8201801,21.9426553 19.9447134,23.9805182 18.1588436,25.5270104 C16.3719462,27.0735026 14.0137349,27.8278891 11.0482457,27.8278891 C7.89266095,27.8278891 5.42039236,26.884906 3.93764773,25.6401684 C1.58046397,23.5278863 0.783090561,20.622479 0.515929367,18.0585845 L5.26934353,17.1900206 Z" id="Fill-24" fill="#FFFFFF" mask="url(#mask-2)"></path>
                        </g>
                        <path d="M0.685473971,118.400342 L0.685473971,113.420372 C0.685473971,110.969636 1.25576037,109.08265 2.43435225,107.762474 C3.61294413,106.404578 5.58890942,105.272999 8.32731166,104.330015 C10.0391984,103.726506 10.91261,103.424752 12.1682676,102.707065 C13.4228977,101.953698 14.0301756,101.086154 14.0301756,99.9912739 C14.0301756,97.729134 12.7375264,96.3335191 10.1522281,96.3335191 C7.41485343,96.3335191 5.89408971,97.9921498 5.58890942,101.27475 L0.8365228,100.444925 C0.951607622,97.842292 1.90208495,95.6922906 3.61294413,93.9949211 C5.36182241,92.2975515 7.52891071,91.4289877 10.1522281,91.4289877 C12.6995074,91.4289877 14.8296041,92.2210934 16.5404633,93.7675857 C18.2893416,95.3140779 19.1627532,97.3896601 19.1627532,99.9912739 C19.1627532,104.028261 16.3873594,106.29142 11.103733,108.064228 C9.12571261,108.705457 7.94712073,109.346685 7.22475796,109.913495 C6.88258613,110.17753 6.65447157,110.517004 6.4643761,110.931916 C6.16022336,111.798441 6.16022336,112.176654 6.16022336,113.495811 L19.3918953,113.495811 L19.3918953,118.400342 L0.685473971,118.400342 Z" id="Fill-27" fill="#FFFFFF"></path>
                        <path d="M78.3483082,113.571963 C78.9196222,113.911437 79.6789765,114.062314 80.5924623,114.062314 C82.3033215,114.062314 83.4808858,113.421086 84.2032486,112.10091 C84.9256113,110.780733 85.3058023,108.327958 85.3058023,104.782342 C85.3058023,102.783217 85.1547534,101.161287 84.8495731,99.9165489 L78.3483082,113.571963 Z M82.9105994,96.8990031 C82.2653024,96.5207904 81.503893,96.3332132 80.5924623,96.3332132 C77.2457545,96.3332132 75.8770672,98.5963726 75.8770672,104.782342 C75.8770672,107.309536 76.0291436,109.234241 76.3713154,110.554417 L82.9105994,96.8990031 Z M80.5924623,91.4286818 C86.6755171,91.4286818 90.4394073,95.9183007 90.4394073,104.782342 C90.4394073,114.477227 86.7895744,118.965826 80.5924623,118.965826 C74.3943226,118.965826 70.7444896,114.477227 70.7444896,104.782342 C70.7444896,95.9183007 74.5083798,91.4286818 80.5924623,91.4286818 L80.5924623,91.4286818 Z" id="Fill-29" fill="#FFFFFF"></path>
                        <polygon id="Fill-31" fill="#FFFFFF" points="143.159764 118.400342 143.159764 113.495811 150.573487 113.495811 150.573487 97.842292 144.832604 101.425628 144.832604 95.7677292 150.953678 91.9957969 155.707093 91.9957969 155.707093 113.495811 162.740625 113.495811 162.740625 118.400342"></polygon>
                        <path d="M225.764567,103.462165 C226.640034,102.820937 227.095235,101.802515 227.095235,100.369181 C227.095235,98.9735658 226.640034,97.9551441 225.688529,97.3139156 C224.738051,96.6726871 223.825593,96.3332132 222.951154,96.3332132 C221.734543,96.3332132 218.693016,96.9744417 218.693016,100.369181 C218.693016,103.76392 221.810581,104.406168 223.10323,104.406168 C224.015689,104.406168 224.890128,104.103394 225.764567,103.462165 L225.764567,103.462165 Z M218.768026,109.950908 C219.225283,112.968454 220.403875,114.062314 223.179269,114.062314 C226.182777,114.062314 227.704568,111.912313 227.742587,107.611291 L227.057216,108.064942 C226.791082,108.252519 226.182777,108.479855 225.2323,108.781609 C224.319841,109.083364 223.407383,109.234241 222.456906,109.234241 C220.213779,109.234241 218.160748,108.479855 216.296785,106.932343 C214.472896,105.38687 213.55941,103.19813 213.55941,100.369181 C213.55941,97.7665475 214.434877,95.6542654 216.183755,93.9568959 C217.932634,92.2595264 220.099722,91.4286818 222.647001,91.4286818 C229.148266,91.4286818 232.837146,95.8418426 232.837146,105.349151 C232.837146,114.439508 229.224304,118.965826 223.179269,118.965826 C218.045663,118.965826 214.928098,116.589509 213.977621,110.743014 L218.768026,109.950908 Z" id="Fill-33" fill="#FFFFFF"></path>
                    </g>
                </g>
            </g>
        </g>
    </g>
</svg>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1571753037"></script>
<script type="text/javascript" src="/js/auto-complete.js?1571753037"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/nodered-workshop.nexmodev.com\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1571753037"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/setting-up/" title="Setting Up" class="dd-item 
        
        
        
        ">
      <a href="/setting-up/">
          Setting Up
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/sending-and-recieving-sms/" title="Sending and Receiving SMS" class="dd-item 
        
        
        
        ">
      <a href="/sending-and-recieving-sms/">
          Sending and Receiving SMS
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/voice-calls/" title="Voice Calls" class="dd-item 
        
        
        
        ">
      <a href="/voice-calls/">
          Voice Calls
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/building-an-ivr/" title="Building an IVR" class="dd-item 
        parent
        active
        
        ">
      <a href="/building-an-ivr/">
          Building an IVR
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/badge-hacking/" title="Badge Hacking" class="dd-item 
        
        
        
        ">
      <a href="/badge-hacking/">
          Badge Hacking
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/'>Node-RED Workshop</a> > Building an IVR
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#initial-call-handling">Initial Call Handling</a></li>
<li><a href="#handling-the-input">Handling the Input</a></li>
<li><a href="#call-paths">Call Paths</a></li>
<li><a href="#expanding-your-ivr">Expanding your IVR</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Building an IVR
            </h1>
          

        




	

<p>An IVR or Interactive Voice Response is a menu of options presented to a caller, they then navigate that menu using the buttons on their keypad to send DTMF (Dual Tone Multi Frequency) signals. IVRs are the fundamental navigation method of Voice Call applications.</p>

<p>Each option on the IVR can direct the call to a different path, for example forwarding the call to a specific destination, playing a recorded piece of information or even triggering another service such as an SMS.</p>

<p>An IVR can have multiple levels to it, where selection of one option presents the user with more options, this can go on to an infinite depth! For this activity we will just create a single level IVR.</p>

<h2 id="initial-call-handling">Initial Call Handling</h2>

<ol>
<li><p>Re-use your flow from the earlier Incoming call example (probably Flow 2). We want to keep the <em>/event</em> webhook from our previous flow so we can see the events and errors.</p></li>

<li><p>We need to handle the incoming call. As before we will start with a &ldquo;voice webhook&rdquo; listening on <code>/answer</code>.</p></li>

<li><p>In response to the webhook we will return an NCCO made up of a &ldquo;talk&rdquo; node that tells the user the options, followed an &ldquo;input&rdquo; node to collect the user&rsquo;s choice.</p></li>

<li><p>Your Flow should look like this:</p>

<p><img src="/IVR_1.png" alt="IVR Inital Call Handler" /></p></li>

<li><p>Next we need to configure the nodes we added, starting with the &ldquo;talk&rdquo; node.</p>

<ul>
<li>We will use the &ldquo;Text&rdquo; field to greet the caller and then offer them our options, something like &ldquo;Hello please press 1 or 2&rdquo; will suffice for now. We can go back and edit the greeting once we have all our options.</li>
<li>Choose a voice name or just leave this as the default.</li>
<li>This time we are also going to tick the <em>Barge In</em> option, what this does is it allows the caller to send their input before the text has finished being read, its very useful in an IVR an prevents poeple from having to listen to a long list of options.</li>
</ul>

<p><img src="/Talk_Options.png" alt="Talk Options" /></p></li>

<li><p>Next we configure the &ldquo;input&rdquo; node, Once the user has entered the required number of digits those will be sent as a new webhook, so we need to configure where that webhook should be sent.</p></li>

<li><p>In the URL field, enter the full address of your NodeRED instance followed by <code>/input1</code> (e.g. <a href="https://monkey.workbench.red/input1">https://monkey.workbench.red/input1</a>).  We use <code>/input1</code> because if we were to later create a second level to our IVR we would need to send that input to a different address, e.g. <code>/input2</code>.</p></li>

<li><p>Set the method to GET. We can leave &ldquo;Submit on Hash&rdquo; unchecked; this option causes the input to be sent when the user presses the # key e.g. for collecting something like an account number.</p></li>

<li><p>Again we will leave the timeout as the default, but we will set &ldquo;Max Digits&rdquo; to 1, this means that we only need the user to press a single key for the input to be sent, which means we can have a maximum of 9 options in our menu.</p>

<p><img src="/Input_Options.png" alt="Input Options" /></p></li>
</ol>

<h2 id="handling-the-input">Handling the Input</h2>

<ol>
<li><p>Set up another &ldquo;voice webhook&rdquo; to handle the user input arriving from Nexmo. It should be configured to listen for a GET on <code>/input1</code> which corresponds to our setting in the &ldquo;input&rdquo; node above.</p></li>

<li><p>The first thing we will do with this flow is to check what number the caller pressed and then branch our flow accordingly. We can do this using one of NodeRED&rsquo;s built in nodes, the &ldquo;switch&rdquo; node. You&rsquo;ll find &ldquo;switch&rdquo; in the &ldquo;function&rdquo; section of the palette.</p></li>

<li><p>To configure the &ldquo;switch&rdquo; node, the first thing we will do is set which property we want to switch on, in this case the digit(s) that the user pressed are send in <code>msg.call.dtmf</code>.</p></li>

<li><p>We then need to set up routes for each option</p>

<ul>
<li>on the first option, use the dropdown to choose &ldquo;is empty&rdquo; so we can handle the case where we don&rsquo;t get any user input. In this scenario Nexmo will send the webhook with the <em>timedout</em> param set to true and <code>msg.call.dtmf</code> will be an empty string.</li>
<li>click the + add button at the bottom to add two additional options</li>
<li>we will set up handlers for <code>== 1</code> and <code>== 2</code> so that we can detect what number the user pressed. These become the second and third output points on the switch node.</li>
</ul>

<p><img src="/Switch_Config.png" alt="Switch Node Config" /></p></li>
</ol>

<h2 id="call-paths">Call Paths</h2>

<p>You will notice that your &ldquo;switch&rdquo; node now has three output links, each one of these represents a different option that you configured. You can hover over them with the mouse to check what each one is. We&rsquo;ll link them up to the actions we want each one to take.</p>

<ol>
<li><p>Firstly we will deal with the <em>is empty</em> path, the simplest thing to do here is to re-present the user with the menu options, so we can simply connect this back to our initial talk node to read the options and then collect input.</p></li>

<li><p>Next we need to do something if the caller presses 1. For this we will connect the caller to another numbe using a &ldquo;connect&rdquo; node from the palette. To configure this node to connect the call to another phone number:</p>

<ul>
<li>The Endpoint should be &ldquo;Phone&rdquo;.</li>
<li>The Number should be another phone number you might have (ask the person next to you if you can use their cellphone number)</li>
<li>The From should be your Nexmo number.</li>
</ul>

<p><img src="/Connect_Node_Config.png" alt="Connect Node Config" /></p></li>

<li><p>For the 2nd option in our IVR we are going to play a short message to let the user know we will send them a link by SMS - and then actually send the SMS. Connect a &ldquo;talk&rdquo; node to the third output of the &ldquo;switch&rdquo; and configure this to say &ldquo;I have sent you the link by SMS&rdquo;.</p></li>

<li><p>Next we are also going to use the &ldquo;send SMS&rdquo; node, we can wire this up in parallel to the talk node so that the SMS is sent as soon as the user has pressed their input.</p>

<p>However we need to do some additional work, the <code>/input1</code> webhook won&rsquo;t get the caller ID of the person that is calling by default, so we need to go back to our input node and configure the URL to send that along with the user&rsquo;s DTMF input.</p>

<p>In the input node edit the URL from <code>/input1</code> to be <code>/input1?from={{msg.call.from}}</code> this will then send the value of &ldquo;from&rdquo; as a new value also called &ldquo;from&rdquo; to our <code>/input1</code> handler.</p></li>

<li><p>Now we can add our &ldquo;send SMS&rdquo; node, select your Nexmo credentials, set the &ldquo;To&rdquo; as <code>{{msg.call.from}}</code> and the &ldquo;From&rdquo; as your Nexmo number. In the text field you can enter a URL of your choice e.g. <a href="https://vonage.com/campus">https://vonage.com/campus</a>, this will be the link we send to the user.</p></li>

<li><p>We need to make sure that the last two paths from the Switch Node are both closed off with a &ldquo;Return NCCO&rdquo; node, you can use separate ones or they can both share the same node.</p></li>

<li><p>Finally we will add a debug node to the end of the Send SMS to log the response from Nexmo.</p>

<p>Your Flow should look like this:</p>

<p><img src="/IVR_Complete.png" alt="IVR Complete" /></p></li>

<li><p><strong>Click deploy</strong> and then go ahead and call your Nexmo number a few times to try all the different options.</p></li>
</ol>

<h2 id="expanding-your-ivr">Expanding your IVR</h2>

<p>Here are some suggestions for additional things to add to your IVR:</p>

<ul>
<li>Try adding a second layer of options to the menu, e.g. a choice of which link to send by SMS</li>
<li>Add an option to connect the caller into a conversation node, this will give you a conference call. Test by having someone else call the same number</li>
<li>Try recording a message from the caller</li>
<li>If you are feeling very adventurous, set up the Email node to email you when someone chooses a particular option</li>
</ul>

<p>There will be people around to help you with these.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/voice-calls/" title="Voice Calls"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/badge-hacking/" title="Badge Hacking" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1571753037"></script>
    <script src="/js/perfect-scrollbar.min.js?1571753037"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1571753037"></script>
    <script src="/js/jquery.sticky.js?1571753037"></script>
    <script src="/js/featherlight.min.js?1571753037"></script>
    <script src="/js/highlight.pack.js?1571753037"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1571753037"></script>
    <script src="/js/learn.js?1571753037"></script>
    <script src="/js/hugo-learn.js?1571753037"></script>

    <link href="/mermaid/mermaid.css?1571753037" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1571753037"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
